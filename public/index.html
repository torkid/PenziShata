<!DOCTYPE html>
<html lang="sw">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PenziShata - Video Mpya Zimevuja Kila Siku</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto+Condensed:wght@400;700&family=Teko:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --brand-red: #E50914;
        }

        body {
            font-family: 'Roboto Condensed', sans-serif;
            /* Font kama ya YouTube */
            background-color: #0A0A0A;
            color: #f1f1f1;
        }

        .font-display {
            font-family: 'Teko', sans-serif;
        }

        /* Staili za Video Card (YouTube-style) */
        .video-list-card {
            margin-bottom: 1rem;
            cursor: pointer;
        }

        .video-thumbnail-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            /* Aspect ratio ya video */
            background-color: #222;
            border-radius: 8px;
            overflow: hidden;
        }

        .video-thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            /* text-xs */
            font-weight: 700;
        }

        .video-details {
            padding-top: 12px;
            /* Flex imeondolewa, si lazima tena */
        }

        /* === CSS YA AVATAR IMEONDOLEWA === */

        .video-text-meta {
            overflow: hidden;
            /* Kuzuia title ndefu kuharibu layout */
        }

        /* *** MODIFIED: Font size imeongezwa kutoka text-base *** */
        .video-title {
            font-size: 1.125rem;
            /* text-lg */
            font-weight: 700;
            color: #f1f1f1;
            line-height: 1.3;
            /* Kuficha text ndefu (ellipsis) */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* *** MODIFIED: Font size imeongezwa kutoka text-sm *** */
        .video-channel-info {
            font-size: 1rem;
            /* text-base */
            color: #aaa;
            margin-top: 4px;
        }

        /* --- PLAY BUTTON STYLE MPYA --- */
        .video-play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            /* Saizi nzuri kwa mobile tap */
            height: 60px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 24px;
            pointer-events: none;
            /* Inaruhusu card yote kubonyezwa */
            transition: all 0.2s ease;
        }

        .video-list-card:hover .video-play-button {
            background-color: rgba(229, 9, 20, 0.8);
            /* Rangi ya brand ikiwa hovered */
            color: white;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .fas {
            line-height: 1;
            /* Kuhakikisha icon inakaa sawa */
        }

        /* --- MWISHO WA PLAY BUTTON STYLE --- */

        /* Staili za Pagination (Unclickable) */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem 0;
            border-top: 1px solid #222;
            margin-top: 1rem;
        }

        .pagination-item {
            padding: 8px 12px;
            margin: 0 4px;
            border-radius: 4px;
            font-weight: 700;
            color: #555;
            /* Rangi iliyofifia */
            background-color: #1a1a1a;
            cursor: not-allowed;
            /* Inaonyesha haibonyezwi */
        }

        .pagination-item.active {
            background-color: var(--brand-red);
            color: white;
        }

        /* === STYLES FOR NEW MODAL (FROM IMAGE) === */
        .modal-card {
            background-color: #ffffff;
            /* White background */
            color: #1f2937;
            /* Dark gray text */
            border-radius: 0.75rem;
            /* rounded-lg */
            padding: 2rem;
            /* p-8 */
            width: 100%;
            max-width: 28rem;
            /* max-w-sm */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .icon-18 {
            width: 3.5rem;
            /* w-14 */
            height: 3.5rem;
            /* h-14 */
            background-color: #dc2626;
            /* bg-red-600 */
            border-radius: 9999px;
            /* rounded-full */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            /* text-xl */
            font-weight: 700;
            margin: 0 auto 1rem auto;
            /* Center */
            /* Removed border */
        }

        .modal-title {
            font-size: 1.25rem;
            /* text-xl */
            font-weight: 700;
            text-align: center;
            color: #1f2937;
        }

        .modal-subtitle {
            font-size: 0.875rem;
            /* text-sm */
            color: #374151;
            /* text-gray-700 (darker) */
            text-align: center;
            margin-top: 0.5rem;
            /* mt-2 */
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
        }

        .modal-label {
            font-size: 0.875rem;
            /* text-sm */
            font-weight: 700;
            /* font-bold */
            color: #1f2937;
            /* text-gray-900 */
            margin-top: 1.5rem;
            /* mt-6 */
            margin-bottom: 0.5rem;
            /* mb-2 */
        }

        .modal-input {
            width: 100%;
            border: 1px solid #d1d5db;
            /* border-gray-300 */
            border-radius: 0.375rem;
            /* rounded-md */
            padding: 0.75rem 1rem;
            /* p-3 */
            font-size: 1.125rem;
            /* text-lg */
            color: #1f2937;
        }

        .modal-input:focus {
            outline: none;
            border-color: #dc2626;
            /* red-600 */
            box-shadow: 0 0 0 2px #fecaca;
            /* red-200 ring */
        }

        .modal-button {
            width: 100%;
            background-color: #dc2626;
            /* bg-red-600 */
            color: white;
            border-radius: 0.375rem;
            /* rounded-md */
            padding: 0.75rem;
            /* p-3 */
            font-weight: 700;
            font-size: 1.125rem;
            /* text-lg */
            margin-top: 1.5rem;
            /* mt-6 */
            transition: background-color 0.2s ease;
        }

        .modal-button:hover {
            background-color: #b91c1c;
            /* bg-red-700 */
        }

        .secure-payment {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            /* text-xs */
            color: #6b7280;
            /* text-gray-500 */
            margin-top: 1.5rem;
            /* mt-6 */
        }

        .payment-logos {
            margin-top: 1rem;
            /* mt-4 */
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            /* space between logos */
        }

        .payment-logos img {
            height: 24px;
            /* h-6 */
            object-fit: contain;
        }

        .modal-footer-text {
            font-size: 0.75rem;
            /* text-xs */
            color: #6b7280;
            /* text-gray-500 */
            text-align: center;
            margin-top: 1.5rem;
            /* mt-6 */
        }


        /* Staili za ATM za zamani (zimefichwa) */
        .atm-screen,
        .atm-text,
        .atm-input,
        .atm-button,
        .loading-circle,
        .blinking-text,
        .bouncing-emoji {
            display: none;
        }
    </style>
</head>

<body class="antialiased">

    <!-- Main Container -->
    <div class="relative min-h-screen flex flex-col">

        <!-- Header Mpya -->
        <header
            class="w-full py-3 px-4 sm:px-8 border-b border-gray-800 sticky top-0 bg-black/70 backdrop-blur-md z-30">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-3xl sm:text-4xl font-black uppercase text-red-600 font-display tracking-wider">
                    PenziShata
                </h1>
                <button
                    class="open-modal-trigger bg-red-600 hover:bg-red-700 transition-all text-white font-bold py-2 px-6 rounded-lg text-sm sm:text-base animate-pulse shadow-lg shadow-red-500/30">
                    Group Za Malaya (TSH 200)
                </button>
            </div>
        </header>

        <!-- Main Content (Video List) -->
        <!-- *** MODIFIED: 'max-w-xl' imebadilishwa kuwa 'max-w-7xl' *** -->
        <main class="flex-grow flex flex-col w-full max-w-7xl mx-auto p-4 sm:p-8">

            <!-- Hapa ndipo video zitawekwa na JavaScript -->
            <!-- *** MODIFIED: Changed 'lg:grid-cols-4' to 'md:grid-cols-4' *** -->
            <div id="video-list-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-8">
                <!-- Mfano wa Card (itaondolewa na JS) -->
                <!-- *** HII SECTION SASA ITAJAZWA NA JS, PAMOJA NA TITLES ZA CATEGORY *** -->
                <div class.="col-span-1 sm:col-span-2 md:col-span-4">
                    <div class="w-full h-64 bg-gray-800 animate-pulse rounded-lg"></div>
                </div>
            </div>

            <!-- Pagination (Unclickable) -->
            <nav class="pagination" aria-label="Pagination">
                <span class="pagination-item active" aria-current="page">1</span>
                <span class="pagination-item">2</span>
                <span class="pagination-item">3</span>
                <span class="pagination-item">...</span>
                <span class="pagination-item">
                    <i class="fas fa-chevron-right"></i>
                </span>
            </nav>

        </main>

        <!-- Footer -->
        <footer class="w-full py-8 px-4 sm:px-8 mt-12 border-t border-white/10">
            <div class="container mx-auto text-center text-gray-500">
                <p>&copy; 2025 PenziShata. Haki zote zimehifadhiwa.</p>
                <div class="mt-2 text-sm">
                    <a href="#" class="hover:text-white mx-2">Vigezo & Masharti</a>
                    <span class="text-gray-600">â€¢</span>
                    <a href="#" class="hover:text-white mx-2">Sera ya Faragha</a>
                </div>
            </div>
        </footer>

    </div>

    <!-- Payment Modal MPYA (Kama Picha) -->
    <div id="payment-modal"
        class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-50 hidden">
        <div id="payment-box" class="modal-card relative">
            <button id="close-modal"
                class="absolute top-3 right-4 text-gray-400 hover:text-gray-600 text-3xl font-light z-20">&times;</button>

            <!-- Form View -->
            <div id="form-view">
                <div class="icon-18">18+</div>
                <!-- MODIFIED: Title changed to match image -->
                <h2 class="modal-title">LIPIA TSH <span class="text-red-600">200</span>/= TU.</h2>
                <!-- MODIFIED: Subtitle changed to match image -->
                <p class="modal-subtitle">Fungua video zote za kikubwa na connection kali za mjini.</p>

                <form id="payment-form">
                    <!-- MODIFIED: Label changed to match image -->
                    <label for="phone" class="modal-label">Weka namba yako ya pesa</label>
                    <input type="tel" id="phone" name="phone" class="modal-input" placeholder="07XXXXXXXX" required
                        pattern="0[6-7][0-9]{8}">
                    <!-- MODIFIED: Button changed to red -->
                    <button type="submit" class="modal-button">
                        <i class="fas fa-lock mr-2"></i> LIPA SASA
                    </button>
                </form>

                <div class="secure-payment">
                    <i class="fas fa-lock w-4 h-4 mr-2"></i> Secure Payment
                </div>

                <!-- MODIFIED: Removed the extra M-Pesa/Tigo logos -->

                <!-- ADDED: Zenopay Logo -->
                <div class="payment-logos" style="margin-top: 1rem;">
                    <img src="https://i.ibb.co/jvqbh208/zenopay-logo.png" alt="zenopay-logo" border="0"
                        class="h-8 mx-auto">
                </div>

                <p class="modal-footer-text">You're supporting PenziShata with this payment.</p>
            </div>

            <!-- Loading View (Inatumia style mpya) -->
            <!-- MODIFIED: Loading spinner changed to red -->
            <div id="waiting-view" class="hidden h-full flex flex-col items-center justify-center text-center py-10">
                <div class="w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin"></div>
                <h3 class="modal-title mt-6 text-red-700">ANGALIA SIMU YAKO!</h3>
                <p class="modal-subtitle mt-2">Tumekutumia ombi la malipo. Weka namba yako siri kumaliza.</p>
                <p class="font-bold text-gray-500 mt-4 animate-pulse">INASUBIRI UTHIBITISHO...</p>
            </div>
        </div>
    </div>

    <script>
        // === NEW VIDEO LIST ===
        // All old videos removed and replaced with the new list

        // === REVERTED: Original categories and titles restored ===
        // === UPDATED: New links inserted into original structure ===

        const newLinks = [
            "https://www.empressleak.xyz/media/videos/tmb/7072/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6995/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6892/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6777/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6726/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6673/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7167/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7047/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7099/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7097/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7071/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/7042/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6991/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6992/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6920/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6904/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6892/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6862/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6777/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6757/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6745/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6726/video.webm",
            // Links for "UTAMU CHUMBANI" (16 links)
            "https://www.empressleak.xyz/media/videos/tmb/6699/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6680/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6671/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6670/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6653/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6651/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6598/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6428/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6254/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6214/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6213/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/6203/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5921/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5863/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5861/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5792/video.webm",
            // Links for "WANAFUNZI WA CHUO" (first 9 links)
            "https://www.empressleak.xyz/media/videos/tmb/5733/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5622/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5590/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5575/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5504/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5492/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5476/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5449/video.webm",
            "https://www.empressleak.xyz/media/videos/tmb/5431/video.webm"
        ];

        let linkIndex = 0;

        const categories = {
            "VIDEO MPYA ZIMEVUJA": [
                { title: "IMEVUJA: Mke wa Mtu Akilia na Mchepuko Gesti", duration: "12:45", src: newLinks[linkIndex++] || "#" },
                { title: "SKENDO: Mwanafunzi wa Chuo Adaiwa Kufanywa Chooni", duration: "08:11", src: newLinks[linkIndex++] || "#" },
                { title: "Mtoto wa Mchungaji AVULIWA WAZIWAZI Live", duration: "05:59", src: newLinks[linkIndex++] || "#" },
                { title: "SHOCKING: Bibi Harusi Akifanywa Kabla ya Ndoa", duration: "15:02", src: newLinks[linkIndex++] || "#" },
                { title: "LEAKED: Housegirl Mwenye Nguo Fupi Apakwa Mafuta", duration: "09:30", src: newLinks[linkIndex++] || "#" },
                { title: "Shemeji Ananiingilia Jikoni Kimya Kimya (Video)", duration: "07:44", src: newLinks[linkIndex++] || "#" },
                { title: "DAKTARI WA KICHAA: Akikojoa Bila Kusimama", duration: "11:21", src: newLinks[linkIndex++] || "#" },
                { title: "Housegirl Amfanyia Mambo Mtoto wa Bosi Wakiwa Peke Yao", duration: "06:33", src: newLinks[linkIndex++] || "#" },
                { title: "VIDEO MPYA UDSM: Mwanafunzi YAVUJA Chumbani", duration: "14:01", src: newLinks[linkIndex++] || "#" },
                { title: "LIVE DALADALA: Ananifunulia Sketi Kwenye Siti", duration: "10:07", src: newLinks[linkIndex++] || "#" },
                { title: "Toto la Sinza Lafundwa na MZEE WA KAZI", duration: "09:55", src: newLinks[linkIndex++] || "#" },
                { title: "ASKARI Amwaga LIVE Mbele ya Mtuhumiwa", duration: "08:22", src: newLinks[linkIndex++] || "#" },
                { title: "Binti Kiziwi AFUNZWA Kutumia Mboo na Fundi", duration: "04:50", src: newLinks[linkIndex++] || "#" },
                { title: "WEMA SEPETU: Video Yake Ya Siri Chumbani YAVUJA", duration: "13:40", src: newLinks[linkIndex++] || "#" },
                { title: "Mke wa Bosi Anataka Kila Siku (IMENASWA)", duration: "07:05", src: newLinks[linkIndex++] || "#" },
                { title: "MGANGA Amfanyia Mambo Mteja Wake wa Kike", duration: "05:15", src: newLinks[linkIndex++] || "#" },
                { title: "Mama Ntilie Mwenye MAZIWA MAKUBWA Afanywa Jikoni", duration: "11:50", src: newLinks[linkIndex++] || "#" },
                { title: "AJICHUA LIVE CHUMBANI: Ajua Narekodi!", duration: "06:19", src: newLinks[linkIndex++] || "#" },
                { title: "Kibibi cha Kisukuma Chatafuna MBOO Ya Mjukuu", duration: "14:59", src: newLinks[linkIndex++] || "#" },
                { title: "KIJANA MDOGO Ampiga Mshua Mkubwa Gesti", duration: "10:20", src: newLinks[linkIndex++] || "#" },
                { title: "TRAFFIC POLISI Anapigwa Chini ya Gari (LEAKED)", duration: "07:31", src: newLinks[linkIndex++] || "#" },
                { title: "Dereva wa Lori Aharibu Mke wa Mtu (VIDEO NZIMA)", duration: "12:08", src: newLinks[linkIndex++] || "#" }
            ],
            "UTAMU CHUMBANI": [
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "08:15", src: newLinks[linkIndex++] || "#" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "11:30", src: newLinks[linkIndex++] || "#" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "05:45", src: newLinks[linkIndex++] || "#" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "14:20", src: newLinks[linkIndex++] || "#" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "07:01", src: newLinks[linkIndex++] || "#" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "09:50", src: newLinks[linkIndex++] || "#" },
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "12:12", src: newLinks[linkIndex++] || "#" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "06:30", src: newLinks[linkIndex++] || "#" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "08:15", src: newLinks[linkIndex++] || "#" },
                { title: "Mke wa Mtu SUMU: Video Yake Akiliwa Tigo", duration: "11:30", src: newLinks[linkIndex++] || "#" },
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "05:45", src: newLinks[linkIndex++] || "#" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "14:20", src: newLinks[linkIndex++] || "#" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "07:01", src: newLinks[linkIndex++] || "#" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "09:50", src: newLinks[linkIndex++] || "#" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "12:12", src: newLinks[linkIndex++] || "#" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "06:30", src: newLinks[linkIndex++] || "#" }
            ],
            "WANAFUNZI WA CHUO": [
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "08:15", src: newLinks[linkIndex++] || "#" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "11:30", src: newLinks[linkIndex++] || "#" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "05:45", src: newLinks[linkIndex++] || "#" },
                { title: "Mke wa Mtu SUMU: Video Yake Akiliwa Tigo", duration: "14:20", src: newLinks[linkIndex++] || "#" },
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "07:01", src: newLinks[linkIndex++] || "#" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "09:50", src: newLinks[linkIndex++] || "#" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "12:12", src: newLinks[linkIndex++] || "#" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "06:30", src: newLinks[linkIndex++] || "#" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "08:15", src: newLinks[linkIndex++] || "#" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "11:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/12/129/12970319/12970319-preview.webm" },
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "05:45", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/12/129/12955831/12955831-preview.webm" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "14:20", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/12/129/12955801/12955801-preview.webm" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "07:01", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/12/129/12942650/1_240.jpg" },
                { title: "Mke wa Mtu SUMU: Video Yake Akiliwa Tigo", duration: "09:50", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/15/150/15072438/15072438-preview.webm" },
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "12:12", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/140/14056187/14056187-preview.webm" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "06:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/140/14041042/14041042-preview.webm" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "08:15", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/140/14040963/14040963-preview.webm" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "11:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/140/14040939/14040939-preview.webm" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "05:45", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/139/13967284/13967284-preview.webm" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "14:20", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/139/13955903/13955903-preview.webm" }
            ],
            "SKENDO ZA MJINI": [
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "07:01", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/139/13933150/13933150-preview.webm" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "09:50", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/138/13841101/13841101-preview.webm" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "12:12", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/133/13365658/13365658-preview.webm" },
                { title: "Mke wa Mtu SUMU: Video Yake Akiliwa Tigo", duration: "06:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/132/13222340/13222340-preview.webm" },
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "08:15", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/131/13194633/6_240.jpg" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "11:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/131/13142077/13142077-preview.webm" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "05:45", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/131/13195057/2_240.jpg" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "14:20", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/130/13013907/13013907-preview.webm" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "07:01", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/9/93/935/9359672/9359672-preview.webm" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "09:50", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/12/127/12760030/12760030-preview.webm" },
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "12:12", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/7072/video.webm" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "06:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/6995/video.webm" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "08:15", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/6892/video.webm" },
                { title: "Mke wa Mtu SUMU: Video Yake Akiliwa Tigo", duration: "11:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/6777/video.webm" },
                { title: "Shemeji Mpenda Zege Anataka Kila Dakika", duration: "05:45", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/6726/video.webm" },
                { title: "KITANDA HAKIZAI: Utamu Mpaka Asubuhi", duration: "14:20", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://www.empressleak.xyz/media/videos/tmb/6673/video.webm" },
                { title: "UTAMU WA FUNDI: Amenifanyia Mambo Nimeshindwa Kutembea", duration: "07:01", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/141/14181416/14181416-preview.webm" },
                { title: "GESTI BUBU: Walivyokutana Kimya Kimya Chumbani", duration: "09:50", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/141/14181442/14181442-preview.webm" },
                { title: "Mwalimu wa Kazi Anipeleka Chake (Full Video)", duration: "12:12", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/141/14179568/14179568-preview.webm" },
                { title: "Toto la Mjini Linalia Utamu Akipigwa Mashine", duration: "06:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "httpss://static-eu-cdn.eporner.com/thumbs/static4/1/14/141/14181491/14181491-preview.webm" },
                { title: "NYEGE ZA OFISINI: Bosi Ananifanyia Mambo Kwenye Meza", duration: "08:15", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/13/138/13844503/13844503-preview.webm" },
                { title: "Fundi Cherehani Ananipima Nguo Chumbani Kwake", duration: "11:30", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/11/119/11940424/11940424-preview.webm" },
                { title: "Dada wa Kazi Aonesha Utamu Wake Wote", duration: "05:45", src: linkIndex < newLinks.length ? newLinks[linkIndex++] : "https://static-eu-cdn.eporner.com/thumbs/static4/1/14/144/14435745/14435745-preview.webm" }
            ]
        };


        document.addEventListener('DOMContentLoaded', () => {

            // --- Element References ---
            const videoListContainer = document.getElementById('video-list-container');

            // Modal elements
            const paymentModal = document.getElementById('payment-modal');
            const closeModalButton = document.getElementById('close-modal');
            const formView = document.getElementById('form-view');
            const waitingView = document.getElementById('waiting-view');
            const paymentForm = document.getElementById('payment-form');
            const paymentBox = document.getElementById('payment-box');

            // --- Function to create a video card (YouTube-style) ---
            const createVideoCard = (video) => {
                const views = (Math.floor(Math.random() * 900) + 100) + 'K';
                const age = (Math.floor(Math.random() * 5) + 1) + ' days ago';

                const card = document.createElement('div');
                card.className = 'video-list-card open-modal-trigger';

                card.innerHTML = `
                    <div class="video-thumbnail-container">
                        <!-- *** MODIFIED: Replaced src with data-src and added preload="none" for lazy loading *** -->
                        <video class="video-thumbnail" loop muted playsinline preload="none" data-src="${video.src}"></video>
                        
                        <div class="video-play-button">
                            <i class="fas fa-play"></i>
                        </div>
                        
                        <span class="video-duration">${video.duration}</span>
                    </div>
                    <div class="video-details">
                        <div class="video-text-meta">
                            <h3 class="video-title">${video.title}</h3>
                            <div class="video-channel-info">
                                <span>${views} views</span> &bull;
                                <span>${age}</span>
                            </div>
                        </div>
                    </div>
                `;

                // Add hover to play functionality
                const videoEl = card.querySelector('video');
                // MODIFIED: Updated mouseenter to check for data-src for lazy loading
                card.addEventListener('mouseenter', () => {
                    if (!videoEl.src && videoEl.dataset.src) { // If src is empty but data-src exists
                        videoEl.src = videoEl.dataset.src;
                        videoEl.load();
                    }
                    videoEl.play().catch(e => { });
                });
                card.addEventListener('mouseleave', () => {
                    videoEl.pause();
                    videoEl.currentTime = 0; // Reset video to start
                });

                return card;
            };

            // --- Jaza Video List ---
            if (videoListContainer) {
                videoListContainer.innerHTML = ''; // Futa loading state

                // *** MODIFIED: Loop through categories ***
                for (const categoryName in categories) {
                    // 1. Ongeza Title ya Category
                    const titleEl = document.createElement('h2');
                    titleEl.className = 'text-2xl sm:text-3xl font-bold text-red-500 mb-4 mt-8 col-span-1 sm:col-span-2 md:col-span-4 font-display uppercase tracking-wider';
                    titleEl.textContent = categoryName;
                    videoListContainer.appendChild(titleEl);

                    // 2. Jaza video za category hiyo
                    const videos = categories[categoryName];
                    videos.sort(() => 0.5 - Math.random()).forEach(video => {
                        videoListContainer.appendChild(createVideoCard(video));
                    });
                }
            }

            // --- Modal Logic ---
            const openModal = () => paymentModal.classList.remove('hidden');
            const closeModal = () => {
                paymentModal.classList.add('hidden');
                setTimeout(() => {
                    formView.style.display = 'block';
                    waitingView.style.display = 'none';
                }, 300);
            };

            function attachModalTriggers() {
                document.querySelectorAll('.open-modal-trigger').forEach(trigger => {
                    if (trigger.dataset.modalAttached) return;
                    trigger.dataset.modalAttached = 'true';

                    trigger.addEventListener('click', (e) => {
                        e.preventDefault();
                        openModal();
                    });
                });
            }

            // Run it once on load for the header button
            attachModalTriggers();

            // *** MODIFIED: Attach triggers after videos are loaded ***
            // We need to re-run this *after* the videos are added
            // Using a simple delay, a better way is a MutationObserver
            setTimeout(attachModalTriggers, 1000); // Re-check for new triggers after 1s


            closeModalButton.addEventListener('click', closeModal);
            paymentModal.addEventListener('click', (event) => {
                if (event.target === paymentModal) {
                    closeModal();
                }
            });

            // Payment Form Logic
            if (paymentForm) {
                paymentForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    formView.style.display = 'none';
                    waitingView.style.display = 'flex';

                    // Initial delay for UX (Spinner)
                    setTimeout(async () => {
                        const phone = document.getElementById('phone').value;
                        try {
                            const response = await fetch('/pay', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ phone: phone })
                            });
                            const result = await response.json();

                            if (!response.ok) {
                                throw new Error(result.message_body || 'Ombi la malipo halikufanikiwa.');
                            }

                            // Payment initiated successfully. Now poll.
                            const orderId = result.reference;

                            // Polling Loop
                            const checkStatus = setInterval(async () => {
                                try {
                                    const statusRes = await fetch(`/check-status?order_id=${orderId}`);
                                    const statusData = await statusRes.json();

                                    if (statusData.status === 'COMPLETED') {
                                        clearInterval(checkStatus);
                                        window.location.href = 'success.html';
                                    } else if (statusData.status === 'FAILED') {
                                        clearInterval(checkStatus);
                                        waitingView.style.display = 'none';
                                        formView.style.display = 'block';
                                        alert("Malipo yameshindikana. Tafadhali jaribu tena.");
                                    }
                                    // If PENDING, do nothing, just wait for next interval
                                } catch (err) {
                                    console.error("Polling error:", err);
                                    // Continue polling on error? Or stop? Let's continue for network blips.
                                }
                            }, 3000); // Poll every 3 seconds

                        } catch (error) {
                            waitingView.style.display = 'none';
                            formView.style.display = 'block';
                            alert("Tatizo limetokea: " + error.message);
                        }
                    }, 1500);
                });
            }

            // --- ADDED: IntersectionObserver for Lazy Loading Videos ---
            const lazyVideos = document.querySelectorAll('video[data-src]');

            const loadVideo = (entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const video = entry.target;
                        video.src = video.dataset.src;
                        video.load();
                        observer.unobserve(video);
                    }
                });
            };

            // Load videos 200px before they enter the viewport
            const videoObserver = new IntersectionObserver(loadVideo, {
                rootMargin: '200px'
            });

            lazyVideos.forEach(video => videoObserver.observe(video));
        });
    </script>
</body>


</html>
